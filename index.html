<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aviation Threat Intelligence Dashboard | OSINT Project</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1d3e 100%);
            color: #e0e0e0;
            line-height: 1.6;
        }

        .header {
            background: rgba(15, 20, 45, 0.9);
            padding: 2rem;
            text-align: center;
            border-bottom: 3px solid #00d4ff;
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
        }

        .header h1 {
            color: #00d4ff;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        }

        .header p {
            color: #a0a0a0;
            font-size: 1.1rem;
        }

        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(0, 212, 255, 0.1);
            border-radius: 20px;
        }

        .live-dot {
            width: 10px;
            height: 10px;
            background: #2ecc71;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: rgba(30, 35, 60, 0.8);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 25px rgba(0, 212, 255, 0.4);
            border-color: #00d4ff;
        }

        .stat-card h3 {
            color: #00d4ff;
            font-size: 0.9rem;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }

        .stat-card .number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fff;
            margin: 0.5rem 0;
        }

        .stat-card .label {
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        .loading {
            color: #ffa502;
            font-style: italic;
        }

        .critical { color: #ff4757; }
        .high { color: #ffa502; }
        .medium { color: #f1c40f; }
        .info { color: #00d4ff; }

        .section {
            background: rgba(30, 35, 60, 0.8);
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            border: 1px solid rgba(0, 212, 255, 0.2);
        }

        .section h2 {
            color: #00d4ff;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
            padding-bottom: 0.5rem;
        }

        .threat-list {
            list-style: none;
        }

        .threat-item {
            background: rgba(20, 25, 45, 0.6);
            padding: 1.2rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            border-left: 4px solid;
            transition: all 0.3s ease;
        }

        .threat-item:hover {
            background: rgba(30, 35, 55, 0.8);
            transform: translateX(5px);
        }

        .threat-item.critical { border-left-color: #ff4757; }
        .threat-item.high { border-left-color: #ffa502; }
        .threat-item.medium { border-left-color: #f1c40f; }
        .threat-item.low { border-left-color: #2ecc71; }

        .threat-item h4 {
            color: #fff;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .threat-item p {
            color: #b0b0b0;
            margin-bottom: 0.5rem;
        }

        .threat-meta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 0.8rem;
        }

        .badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge.critical {
            background: rgba(255, 71, 87, 0.2);
            color: #ff4757;
        }

        .badge.high {
            background: rgba(255, 165, 2, 0.2);
            color: #ffa502;
        }

        .badge.medium {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
        }

        .badge.low {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }

        .cve-link {
            color: #00d4ff;
            text-decoration: none;
            font-weight: 600;
        }

        .cve-link:hover {
            text-decoration: underline;
        }

        .refresh-btn {
            background: rgba(0, 212, 255, 0.2);
            color: #00d4ff;
            border: 2px solid #00d4ff;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
        }

        .refresh-btn:hover {
            background: rgba(0, 212, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
        }

        .refresh-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: #a0a0a0;
            border-top: 1px solid rgba(0, 212, 255, 0.2);
        }

        footer a {
            color: #00d4ff;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚úàÔ∏è Aviation Threat Intelligence Dashboard</h1>
        <p>OSINT-based Cybersecurity Analysis with Real-time Data</p>
        <div class="live-indicator">
            <div class="live-dot"></div>
            <span id="lastUpdate">Cargando datos...</span>
        </div>
    </div>

    <div class="container">
        <!-- KPI Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>CVEs en Aviaci√≥n</h3>
                <div class="number info" id="totalCVEs">
                    <span class="loading">Cargando...</span>
                </div>
                <div class="label">Vulnerabilidades identificadas</div>
            </div>
            <div class="stat-card">
                <h3>CVEs Cr√≠ticos</h3>
                <div class="number critical" id="criticalCVEs">
                    <span class="loading">Cargando...</span>
                </div>
                <div class="label">Severidad cr√≠tica</div>
            </div>
            <div class="stat-card">
                <h3>CVEs Alto Riesgo</h3>
                <div class="number high" id="highCVEs">
                    <span class="loading">Cargando...</span>
                </div>
                <div class="label">Severidad alta</div>
            </div>
            <div class="stat-card">
                <h3>√öltima Actualizaci√≥n</h3>
                <div class="number medium" id="recentCount">
                    <span class="loading">Cargando...</span>
                </div>
                <div class="label">CVEs √∫ltimos 30 d√≠as</div>
            </div>
        </div>

        <!-- Real-time CVEs Section -->
        <div class="section">
            <h2>üö® Vulnerabilidades Recientes (Datos en Tiempo Real)</h2>
            <button class="refresh-btn" onclick="loadCVEData()" id="refreshBtn">
                üîÑ Actualizar Datos
            </button>
            <ul class="threat-list" id="cveList">
                <li class="threat-item medium">
                    <p style="text-align: center; color: #ffa502;">
                        ‚è≥ Consultando base de datos NVD (NIST)...
                    </p>
                </li>
            </ul>
        </div>

        <!-- Static Threats Section -->
        <div class="section">
            <h2>üéØ Amenazas Espec√≠ficas del Sector (An√°lisis OSINT)</h2>
            <ul class="threat-list">
                <li class="threat-item critical">
                    <h4>Ransomware Dirigido a Aerol√≠neas</h4>
                    <p>Campa√±as de ransomware explotando vulnerabilidades en sistemas VPN de reservas.</p>
                    <div class="threat-meta">
                        <span class="badge critical">CR√çTICO</span>
                        <span class="badge">T1190 - Exploit Public-Facing Application</span>
                    </div>
                </li>
                <li class="threat-item high">
                    <h4>Vulnerabilidades en ADS-B</h4>
                    <p>Posibilidad de manipulaci√≥n de se√±ales ADS-B con impacto en gesti√≥n de tr√°fico a√©reo.</p>
                    <div class="threat-meta">
                        <span class="badge high">ALTO</span>
                        <span class="badge">T1557 - Man-in-the-Middle</span>
                    </div>
                </li>
                <li class="threat-item high">
                    <h4>Interceptaci√≥n de Comunicaciones ACARS</h4>
                    <p>Mensajes ACARS sin cifrar exponen planes de vuelo y datos de mantenimiento.</p>
                    <div class="threat-meta">
                        <span class="badge high">ALTO</span>
                        <span class="badge">T1040 - Network Sniffing</span>
                    </div>
                </li>
            </ul>
        </div>
    </div>

    <footer>
        <p>Aviation Threat Intelligence Dashboard - OSINT Project con Datos en Tiempo Real</p>
        <p>Created by <a href="https://github.com/3stefani" target="_blank">Estefan√≠a Ram√≠rez Mart√≠nez</a></p>
        <p style="margin-top: 0.5rem; font-size: 0.9rem;">
            Datos obtenidos de: <a href="https://nvd.nist.gov/" target="_blank">NVD (NIST)</a>
        </p>
    </footer>

    <script>
        // Funci√≥n para obtener CVEs reales de la API de NVD
        async function loadCVEData() {
            const btn = document.getElementById('refreshBtn');
            btn.disabled = true;
            btn.textContent = '‚è≥ Actualizando...';

            try {
                // B√∫squeda de CVEs relacionados con aviaci√≥n
                const keywords = ['aircraft', 'aviation', 'airline', 'flight'];
                const searchTerm = keywords[Math.floor(Math.random() * keywords.length)];
                
                const response = await fetch(
                    `https://services.nvd.nist.gov/rest/json/cves/2.0?keywordSearch=${searchTerm}&resultsPerPage=10`
                );

                if (!response.ok) throw new Error('Error en la API');

                const data = await response.json();
                displayCVEs(data.vulnerabilities || []);
                updateStats(data.vulnerabilities || []);
                
                document.getElementById('lastUpdate').textContent = 
                    `Actualizado: ${new Date().toLocaleString('es-ES')}`;

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('cveList').innerHTML = `
                    <li class="threat-item high">
                        <h4>‚ö†Ô∏è Error al cargar datos</h4>
                        <p>No se pudieron obtener datos de la API NVD. Mostrando datos de ejemplo.</p>
                    </li>
                `;
                loadSampleData();
            } finally {
                btn.disabled = false;
                btn.textContent = 'üîÑ Actualizar Datos';
            }
        }

        function displayCVEs(vulnerabilities) {
            const cveList = document.getElementById('cveList');
            
            if (!vulnerabilities || vulnerabilities.length === 0) {
                cveList.innerHTML = `
                    <li class="threat-item medium">
                        <p>No se encontraron CVEs recientes. Intenta de nuevo en unos minutos.</p>
                    </li>
                `;
                return;
            }

            cveList.innerHTML = vulnerabilities.map(item => {
                const cve = item.cve;
                const cveId = cve.id;
                const description = cve.descriptions?.find(d => d.lang === 'en')?.value || 'Sin descripci√≥n';
                const published = new Date(cve.published).toLocaleDateString('es-ES');
                
                // Obtener severidad
                const metrics = cve.metrics?.cvssMetricV31?.[0] || cve.metrics?.cvssMetricV2?.[0];
                const severity = metrics?.cvssData?.baseSeverity || 
                               metrics?.baseSeverity || 'MEDIUM';
                
                const score = metrics?.cvssData?.baseScore || 
                            metrics?.baseScore || 'N/A';

                const severityClass = severity.toLowerCase();
                const severityText = severity === 'CRITICAL' ? 'CR√çTICO' :
                                   severity === 'HIGH' ? 'ALTO' :
                                   severity === 'MEDIUM' ? 'MEDIO' : 'BAJO';

                return `
                    <li class="threat-item ${severityClass}">
                        <h4>
                            <a href="https://nvd.nist.gov/vuln/detail/${cveId}" 
                               target="_blank" 
                               class="cve-link">${cveId}</a>
                        </h4>
                        <p>${description.substring(0, 200)}${description.length > 200 ? '...' : ''}</p>
                        <div class="threat-meta">
                            <span class="badge ${severityClass}">${severityText} (${score})</span>
                            <span class="badge">Publicado: ${published}</span>
                        </div>
                    </li>
                `;
            }).join('');
        }

        function updateStats(vulnerabilities) {
            const total = vulnerabilities.length;
            let critical = 0, high = 0, recent = 0;

            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);

            vulnerabilities.forEach(item => {
                const metrics = item.cve.metrics?.cvssMetricV31?.[0] || 
                              item.cve.metrics?.cvssMetricV2?.[0];
                const severity = metrics?.cvssData?.baseSeverity || 
                               metrics?.baseSeverity || 'MEDIUM';
                
                if (severity === 'CRITICAL') critical++;
                if (severity === 'HIGH') high++;

                const published = new Date(item.cve.published);
                if (published >= thirtyDaysAgo) recent++;
            });

            document.getElementById('totalCVEs').textContent = total;
            document.getElementById('criticalCVEs').textContent = critical;
            document.getElementById('highCVEs').textContent = high;
            document.getElementById('recentCount').textContent = recent;
        }

        function loadSampleData() {
            document.getElementById('totalCVEs').textContent = '10';
            document.getElementById('criticalCVEs').textContent = '2';
            document.getElementById('highCVEs').textContent = '5';
            document.getElementById('recentCount').textContent = '3';
        }

        // Cargar datos al iniciar
        window.addEventListener('load', () => {
            setTimeout(loadCVEData, 1000);
        });

        // Auto-refresh cada 5 minutos
        setInterval(loadCVEData, 300000);
    </script>
</body>
</html>
